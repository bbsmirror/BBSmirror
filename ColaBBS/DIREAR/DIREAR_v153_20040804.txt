[CardWare]索引檔案編輯重建程式(DIREAR) v1.53  Release


[程式資訊]

  1)程式說明: 重建遺失或故障的各類BBS索引檔案，亦提供編輯索引檔功能。
              (This Program Only For ColaBBS 01040X Beta Series)
  2)版    本: Version 1.53  2004/08/04
  3)設 計 者: Thyme
  4)下載網址: http://LH.twbbs.org/download/
  5)支援社群: http://LH.twbbs.org/colabbs/
  6)程式大小: 主程式(DIREAR.exe) - 475,136 Bytes
  7)畫面觀賞: http://LH.twbbs.org/download/file/DIREAR_v153.gif
  8)注意事項: 0.產生大量文章數量之索引檔，在速度較慢之主機將會造成程式暫時沒
                有回應之現象，為正常現象，請耐心等候，勿強制關閉程式！
              1.若先前有安裝過舊版程式，請利用控制台當中的新增移除程式功能，
                請先移除舊版程式後，再行重新安裝最新版本程式。
              2.謝謝您的使用，如果有任何問題，請幫忙反應，以利改進，謝謝 :)
                作者信箱：thyme﹒bbs＠LH﹒twbbs﹒org或ilan＠ms3﹒url.com﹒tw
  9)試用期限：無，個人非營利可永久免費使用，無任何限制。
 10)取得授權：個人非營利欲取得正式授權，請掃描一張您家鄉的風景名信片，並寫上
              您的真實姓名、電話、住址等，e-mail至 ilan＠ms3﹒url.com﹒tw ，
              即為取得個人正式授權。
 11)特別聲明：若因使用本軟體，導致有任何資料之損壞，本人不負任何相關責任。
 12)版權宣告：本軟體若為個人非營利使用下，完全免費！在不涉及商業行為及反組譯
              或修改程式內容下，可自由流傳或拷貝。（保留其他相關權利，若有商
              業上使用請務必先行聯絡作者取得授權）
 13)聯絡作者：thyme﹒bbs＠LH﹒twbbs﹒org、ilan＠ms3﹒url﹒com﹒tw
            、telnet://LH.twbbs.org


[作者的話]
強烈建議所有本程式的舊用戶更新至Version 1.53版以後，Version 1.53版de出非常多
的bugs，以及作了許許多多完整的支援與處理。非常建議所有ColaBBS管理人員都下載
使用本程式來協助BBS系統之維護管理工作。


[FAQs]

[程式效能問題]
Q1: 請問這個程式處理效能大約為何？
A1: 大部分的工作皆可在三十秒或一分鐘內完成，若是處理大量之文章檔案，則需要花
    費較多時間，而實際花費的時間視電腦硬體環境而定。如以CPU:2G, HD:IDE ATA10
    0之電腦硬體下RUN、處理五千文章檔案數為例，讓程式自動產生索引檔，則大約需
    要五分鐘時間。

[轉信瞬間流入大量文章問題]
Q1: 轉信瞬間流入大量文章，會使ColaBBS無法正常讀取討論區
A1: 是的，因此本程式於v1.5版後，已經加入處理.AA~.ZZ之文章檔案正常處理與自動
    轉換。採用本程式v1.5版後，即可順利地解決此「轉信瞬間流入大量文章」問題。

Q2: 請問要如何在DIREAR程式裡，處理「轉信瞬間流入大量文章」問題。
A2: 執行本程式之第一主要功能頁面(自動產生新索引 Auto Generated)，當中的「自
    動產生新索引檔」功能，即有提供「自動處理轉信瞬間流入大量文章問題」之功能
    。不過目前只有該功能頁面(自動產生索引頁面)提供本功能，其他功能頁面(自製
    與編輯功能頁面)目前並無提供此處理功能。

Q3: 是不是因為檔名的長度超過索引檔(.DIR)的檔案結構空間，使得讀取出現錯亂呢？
A3: 不是的，即便索引檔(.DIR)正常編製，Cola核心依舊無法正常讀取.AA~.ZZ檔案，
    因此需要一個轉換機制，將.AA~.ZZ之文章檔名轉換為.A~.Z檔名，方能使ColaBBS
    正常讀取討論區。本程式v1.5版起，即提供了此自動轉換功能。

[程式功能問題]
Q1: 這個索引檔案重建與編輯程式，可以處理哪些索引檔案呢？
A1: 可以處理目前ColaBBS所有相關的索引檔案，除討論區索引外，亦包括了精華區與
    使用者站上信箱郵件檔之檔案索引，並且皆可正常重新編製無誤。

Q2: 這個索引檔案重建與編輯程式，是否可以用來合併討論區、精華區，甚至使用者信
    箱。
A2: 可以的，本程式甚至可以混合編製討論區、精華區、使用者郵件之檔案索引。

Q3: 這個索引檔案重建與編輯程式，可以處理索引檔哪些問題？
A3: 已解決大多數索引檔故障、異常與BBS系統版面讀取異常等問題。

[程式執行問題]
Q1: 這個索引檔案重建與編輯程式，是否可以在ColaBBS運行中執行，是否會讓ColaBBS
    發生錯誤或問題呢？
A1: 請放心，本程式已經經過測試，可以在ColaBBS運行中正常無誤地執行。可在Cola
    運轉下重新編製索引檔，Cola亦能正常地重新讀入新索引檔。

[解決ColaBBS原程式產生的Bugs]
  1) 系統無法處理同一秒發表的文章26篇以上
    [.AA~.ZZ之文章檔案處理錯誤，與造成版面無法閱讀問題]
     狀況描述：進入討論區列表立即自動斷線、重新啟動系統時會卡在
               Loading Boards......文章編號
     錯誤情形：系統無法處理、載入含有 .AA ∼ .ZZ 為尾檔名的文章的文章索引
  2) 1.系統Expire、刪除文章或信件時，索引檔未能完整回寫或索引檔寫入錯誤
       狀況描述：於討論區列表中，某版面之文章顯示數量突然降至0或是大量減少
                 ，或是Mail突然全部消失或是大量減少
       錯誤情形：1.產生之新索引檔長度為零 2.產生之新索引檔內容有錯誤
     2.BoardExpire發生錯誤(Expire處理索引檔案時有問題)，造成版面索引檔故障問題
      [文章檔案仍在，但索引檔案卻編成0長度，或僅存在.DIR.DELETED備份索引檔案]
  3) 放入文摘中的文章(被G起來的文章)之索引檔處理遺失與錯誤
  4) 某些文章檔案會遺漏編入索引檔
  5) 與某些新聞伺服器轉信時，版面上文章日期順序繁亂
備註:
1.原作者之RebuildDIR程式並無法處理以上索引檔案Bugs，而DIREAR程式已解決此些問題
2.由於ColaBBS 01040X系列檔案結構改變，RebuildDIR程式無法於01040X系列使用


[已知問題、下版改進與新增功能]
[下版]自動產生巢狀精華區之索引檔
[下版]第二功能與第三功能亦能自動轉換.AA~.ZZ檔案
[下版]第四功能: 智慧型功能
      1. Auto Scan All boards and show status
      2. Give Suggests to Administrator


[版本資訊]

v1.52
[新增]檔案覆蓋前「偵測、警告」與完整機制
[新增]新增精華區資料夾自動判斷之完整機制
[新增]新增「多種還原索引檔案方式」之功能
[新增]第二功能新增「讓使用者決定索引檔案儲存路徑」機制
[新增]第三功能可以編修任何檔名之索引檔案
[新增]所有功能支援處理，超過2,147,483,647之數字檔名
[新增]讀入索引檔時，濾除deliverTag欄位之亂碼，只顯示有意義之文章屬性
[新增]讀入索引檔時，濾除flag欄位之亂碼，只顯示有意義之文章屬性
[新增]讀入索引檔時，濾除reserved欄位之亂碼
[調整]第二功能之「顯示檔案類型」之「預設顯示類型功能」調整
[調整]第一功能之「產生索引類別」之「自動偵測功能」調整
[調整]第一功能之「索引檔案備份系列功能」調整
[修正]極少數某些文章檔案會遺漏編入索引檔內
      1. 編入索引檔時，若該秒之文章檔案英文序號為不連續，則會導
         致該檔案資訊空白編入索引檔內。
[修正]自動編製精華區之索引檔時，會發生錯誤。(資料夾判斷錯誤)
[修正]第一功能之「索引檔案存在資訊」之資訊顯示正確
[修正]第三功能「儲存索引檔案」後，載入顯示的索引檔為修改前的
[修正]取消第三功能「儲存索引檔案」後，自動載入顯示修改後的索引檔
[修正]第二功能與第三功能於「儲存點選項目之欄位資訊異動」後排序，
      會使產生索引檔時發生錯誤
[修正]儲存索引檔案時，會將先前的檔案資訊一併寫入
     (先前的檔案資訊未於排序表格中清除)
[修正]編修索引檔案時，輸入之檔名若含有小寫英文字母，會使產生索引
      檔時發生錯誤
[修正]在已有.DIR.BAK檔的情形下，再度重新編製索引檔，會造成原有之
      .DIR.BAK被覆蓋。
     (已改為程式會自動將原先的.DIR.BAK備份為.DIR.BAK.BAK)
[修正]第一功能在有.DIR.BAK情形下，會遺漏顯示.DIR.BAK.BAK
[修正]第一功能在有.DIR.DELETED情形下，會遺漏顯示.DIR.DELETED.BAK
[修正]第一功能之「索引檔案存在資訊」之資訊顯示正確

v1.51
[修正]極少數某些文章檔案會遺漏編入索引檔內
      1. 編入索引檔時，同一秒之系列文章檔案做過「自動檔名排序」
         後，只判別數字檔名部分，導致存入重複檔名、同秒文章檔案
         被略過。
[新增]正常處理「暱稱欄位缺乏)符號」之文章檔案
      2. 文章檔案作者欄位或暱稱欄位過長，導致缺乏")"符號時，會被
         忽略編入索引檔中。
[新增]正常處理「ANSI Color Code缺陷」之文章檔案
      3. 文章檔案作者欄位或暱稱欄位過長，導致有「ANSI Color Code
         缺陷」時，會被忽略編入索引檔中。
[新增]正常處理「空文章標題」之文章檔案
[修正]誤判文章標頭長度，導致無法將該文章檔案編入索引檔
[調整]取消第二功能之「表格排序」功能
     (該功能已由v1.5之「存檔自動排序」功能取代)
[調整]第一功能之「程式運行狀態顯示」功能

v1.5
[新增]將.AA∼.ZZ檔案，轉換為(+1).A∼(+26).Z [遇重複檔名會自動遞
      延轉換] (即便索引檔正常，ColaBBS仍無法正常讀取索引檔，因此
      需要作檔名轉換處理)
[新增]按照文章檔案時間排序製作索引檔 [第一至第三功能均具備檔名自
      動「正確」排序]
[新增]第二功能(自製新索引)，「產生索引檔」功能增加「指定儲存路徑
      」功能
[新增]第一功能(自動產生新索引)，增加「直接輸入路徑」切換路徑功能
[新增]新增支援以下符號作為文章標頭左側框線符號
     (╭ ╰ ┌ └       ├    │ )
[新增]作者欄位完整判別支援
[新增]數項容錯處理與警示說明
[修正]執行階段錯誤'5'，程序或呼叫不正確
      例如: 處理作者欄位含有"."之文章檔案
      作者 ".." <candy1213@bbs.openfind.com.tw>
[修正]在作者欄位缺乏暱稱欄位時，會遺漏該文章檔案未編入索引檔內
[修正]開啟索引檔案時，取消開啟，程式卻照常開啟檔案
[修正]文章作者欄位有[",Chr(34)]時，顯示字元會吃掉的問題
[修正]文章標題欄位有[",Chr(34)]時，顯示字元會吃掉的問題
      例如: 
      標題 Cancel "77歲的狗爺爺陃福亟需您的幫助！ 2004.7.11"
[調整]儲存索引檔案後，不再做列表Reverse排序
[調整]檔案列表顯示格式調整

v1.2
[新增]正常處理.AA∼.ZZ之文章檔案
     [可正常編製該類之文章檔案之索引檔]

v1.11
[新增]加入大部分的ANSI Color Code完整支援
     (僅Color Code部份，閃爍、底線、跳行、控制等ANSI Code除外)

v1.1
[新增]增強ANSI Color Code支援
[新增]支援左側加入框線符號之Article Title格式
      說明: 目前支援以下符號作為文章標頭左側框線符號
           (╭ ╰ │        ├   )
例如: ucd.twbbs.org版本格式(文章標頭長度80)
╭作者 LiWei (去學校)                                 幫派  Announce
│標題 [公告]  新增 金門日報線上觀看 功能                           
│時間 Tue Jun 15 23:51:46 2004                                     

v1.01
[新增]支援以下二種格式之Article Title
格式一: 原始版本標準格式(文章標頭長度80)
 作者  thyme (繼續努力向前行^^)                       看板  SYSOPs_Program
 標題  [CardWare]索引檔案編輯重建程式(DIREAR) v1.1                        
 時間  Mon Jul 12 18:03:25 2004                                           
格式二: 修正版本格式(文章標頭長度78)
作者 thyme (繼續努力向前行^^)                       看板  SYSOPs_Program
標題 [CardWare]索引檔案編輯重建程式(DIREAR) v1.1                        
時間 Mon Jul 12 18:03:25 2004                                           